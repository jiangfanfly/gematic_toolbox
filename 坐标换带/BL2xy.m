function[x,y]=BL2xy(B,L,L0,n)
%大地坐标转换为高斯坐标的函数
%B,L为大地坐标,中央子午线L0
%n为椭球编号,n=1:克拉索夫斯基椭球;n=2,IUGG1975椭球;n=3WGS84椭球;n=4:CGCS2000椭球
%x,y输出为高斯平面坐标
B=dms2rad(B);
L=dms2rad(L);
L0=dms2rad(L0);
ellipsoid=get_ellipsoid(n); %获取椭球参数
a=ellipsoid.a;
b=ellipsoid.b;
e=(sqrt(a^2-b^2))/a;
e1=(sqrt(a^2-b^2))/b;
X=get_X(B,a,b,e1);
V=sqrt(1+(e1.^2).*cos(B).^2);
c=(a.^2)/b;
M=c./(V.^3);
N=c./V;
t=tan(B);
n1=sqrt((e1.^2).*(cos(B)).^2);
l=L-L0;
xp1=X;
xp2=(N.*sin(B).*cos(B).*l.^2)./2;
xp3=(N.*sin(B).*((cos(B)).^3).*(5-t.^2+9.*n.^2+4.*n.^4).*l.^4)./24;
xp4=(N.*sin(B).*((cos(B)).^5).*(61-58.*t.^2+t.^4).*l.^6)./720;
x=xp1+xp2+xp3+xp4;
yp1=N.*cos(B).*l;
yp2=N.*(cos(B)).^3.*(1-t.^2+n.^2).*l.^3./6;
yp3=N.*(cos(B)).^5.*(5-18.*t.^2+t.^4+14.*n.^2-58.*(n.^2).*(t.^2)).*l.^5./120;
y=yp1+yp2+yp3;
end

